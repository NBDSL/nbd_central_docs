
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Simulation &#8212; PELE 1.5.${BUILD_TAG} documentation</title>
    <link rel="stylesheet" href="../../../_static/naturemodified.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.5.${BUILD_TAG}',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Basic Analysis" href="../GeneralAnalysis/GeneralAnalysis.html" />
    <link rel="prev" title="Software" href="../Software/Software.html" /> 
    <script type="text/javascript" >
    MathJax.Hub.Config({
        TeX: { 
	  Macros: {
	    AA: '{\\unicode{xC5}}'
	  }
	}
    });
    </script>

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../GeneralAnalysis/GeneralAnalysis.html" title="Basic Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../Software/Software.html" title="Software"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">PELE 1.5.${BUILD_TAG} documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../intro.html" >Introduction</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../AdaptiveMethodology.html" accesskey="U">Adaptive Method</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="simulation">
<h1>Simulation<a class="headerlink" href="#simulation" title="Permalink to this headline">¶</a></h1>
<p>In this stage the AdaptivePELE input is built
and the simulation is launched</p>
<div class="section" id="input">
<h2>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h2>
<p>To launch AdaptivePELE we must build 2 control files:</p>
<blockquote>
<div><ul class="simple">
<li>PELE controlfile</li>
<li>AdaptivePELE controlfile</li>
</ul>
</div></blockquote>
<div class="section" id="adaptivepele-controlfile">
<h3>AdaptivePELE controlfile<a class="headerlink" href="#adaptivepele-controlfile" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>General Params</strong>: These parameters control the general aspects of the simulation, such as the initial structures or the output path. For example, if you consider that a simulation did not explore the energy landscape sufficiently, it can be automatically resumed. For more informatio, please refer to: <a class="reference external" href="https://adaptivepele.github.io/AdaptivePELE/Examples.html#generalparams-block">AdaptivePELE GeneralParams section</a>.</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="nt">&quot;generalParams&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;restart&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">&quot;outputPath&quot;</span><span class="p">:</span><span class="s2">&quot;OUTFILES&quot;</span><span class="p">,</span>
    <span class="nt">&quot;initialStructures&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ref.pdb&quot;</span><span class="p">]</span>
<span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<ul>
<li><p class="first"><strong>Spawning Block</strong>: At the end of each iteration (called epochs), trajectories are spawned in different interesting clusters, according to a reward function.</p>
<blockquote>
<div><p>The most used strategies are:</p>
<ul class="simple">
<li>inverselyProportional: Distributes the processors with a weight that is inversely proportional to the cluster population.</li>
<li>epsilon: An epsilon fraction of processors are distributed proportionally to the value of a metric, and the rest are inverselyProportional distributed. A param n can be specified to only consider the n clusters with best metric.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>For more spawning strategies refer to: <a class="reference external" href="https://adaptivepele.github.io/AdaptivePELE/Examples.html#spawning-block">AdaptivePELE spawning section</a></p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="nt">&quot;spawning&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;epsilon&quot;</span><span class="p">,</span>
    <span class="nt">&quot;params&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;reportFilename&quot;</span> <span class="p">:</span> <span class="s2">&quot;run_report&quot;</span><span class="p">,</span>
    <span class="nt">&quot;metricColumnInReport&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="nt">&quot;epsilon&quot;</span> <span class="p">:</span> <span class="mf">0.25</span>
   <span class="p">}</span>
<span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<ul>
<li><p class="first"><strong>Simulation Block</strong>: When using PELE as a propagator, the following parameters are mandatory:</p>
<blockquote>
<div><ul class="simple">
<li>iterations (integer, mandatory): Number of adaptive sampling iterations to run.  [20 small number of iterations, 50 default, 100 large]</li>
<li>processors (integer, mandatory): Number of processors to use with PELE [20 small sampling, 60 default, 150 exhaustive sampling]</li>
<li>peleSteps (integer, mandatory): Number of PELE steps in a epoch (iteration). As less you have the more you will move from one area to the other but less conformational sampling you will have. [ 4 small conformational sampling but high exploration on space, 8 default, 12 exhaustive conformational sampling in a certain area but low exploration space]</li>
<li>seed (integer, mandatory): Seed for the random number generator</li>
<li>controlFile (string, mandatory): Path to the PELE control file. Check the <a class="reference external" href="../../Simulation/Simulation.html#Input">PELE controlFile section</a> for more.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>For more info on the Simulation Block, please refer to: <a class="reference external" href="https://adaptivepele.github.io/AdaptivePELE/Examples.html#simulation-block">https://adaptivepele.github.io/AdaptivePELE/Examples.html#simulation-block</a></p>
<div class="highlight-json"><div class="highlight"><pre><span></span>    <span class="p">{</span>
    <span class="nt">&quot;simulation&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;pele&quot;</span><span class="p">,</span>
    <span class="nt">&quot;params&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;iterations&quot;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
        <span class="nt">&quot;processors&quot;</span> <span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
        <span class="nt">&quot;peleSteps&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="nt">&quot;seed&quot;</span><span class="p">:</span> <span class="mi">123456</span><span class="p">,</span>
        <span class="nt">&quot;controlFile&quot;</span> <span class="p">:</span> <span class="s2">&quot;pele.conf&quot;</span>
    <span class="p">}</span>
<span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>Cluster Block</strong>: Given some clusters, a conformation is said to belong to a cluster when it differs in less than a certain metric threshold (e.g. ligand RMSD) to the corresponding cluster center. Cluster centers are always compared in the same order, and, if there is no similar cluster, it generates a new one. This clusters will be later used to spawn the processors in an Adaptive Sampling fashion.</li>
</ul>
<p>Aside from the speed, a big advantage of using this method is that it permits the user to define different criteria in different regions. This way, we can optimize the number of clusters, giving more importance to regions with more interactions, potentially being more metastable.
In order to measure the potential metastability, we use the ratio of the number of protein-ligand heavy atom contacts over the number of ligand heavy atoms, r. Two atoms are considered to be in contact if the distance between them is less than a certain contactThreshold (8Å by default). Although these values depend on the particular protein-ligand geometry and ligand size, this measure is more ligand-independent compared to the overall number of contacts and a value of 1 typically indicates that the ligand is on the surface entering a protein pocket. We encourage the use of default parameters with very few exceptions such as in the study of the diffusion of ions or tiny molecules (e.g. a oxygen molecule).
For more information about the clustering block and its parameters. Please, refer to: ` AdaptivePELE cluster section &lt;<a class="reference external" href="https://adaptivepele.github.io/AdaptivePELE/Examples.html#clustering-block">https://adaptivepele.github.io/AdaptivePELE/Examples.html#clustering-block</a>&gt;`__</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;clustering&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;rmsd&quot;</span><span class="p">,</span>
    <span class="nt">&quot;params&quot;</span> <span class="p">:</span> <span class="p">{</span>
       <span class="nt">&quot;ligandResname&quot;</span> <span class="p">:</span> <span class="s2">&quot;DRG&quot;</span><span class="p">,</span>
       <span class="nt">&quot;contactThresholdDistance&quot;</span> <span class="p">:</span> <span class="mi">8</span>
    <span class="p">},</span>
    <span class="nt">&quot;thresholdCalculator&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;heaviside&quot;</span><span class="p">,</span>
     <span class="nt">&quot;params&quot;</span> <span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;values&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
          <span class="nt">&quot;conditions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="pele-controlfile">
<h3>PELE controlfile<a class="headerlink" href="#pele-controlfile" title="Permalink to this headline">¶</a></h3>
<p>Refer to <a class="reference external" href="../../Simulation/Simulation.html#Input">PELE controlFile section</a> to learn how to prepare a PELE controlfile.</p>
</div>
</div>
<div class="section" id="launch-adaptivepele">
<h2>Launch AdaptivePELE<a class="headerlink" href="#launch-adaptivepele" title="Permalink to this headline">¶</a></h2>
<div class="section" id="from-command-line">
<h3>From command line<a class="headerlink" href="#from-command-line" title="Permalink to this headline">¶</a></h3>
<p>Command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">AdaptivePELE</span><span class="o">.</span><span class="n">adaptiveSampling</span> <span class="n">control_file</span>
</pre></div>
</div>
</div>
<div class="section" id="from-queue-system">
<h3>From queue system<a class="headerlink" href="#from-queue-system" title="Permalink to this headline">¶</a></h3>
<p>Place the command before in a .sh file with
the specificacitions of your queue system and launch it</p>
<p>Example slurm file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH -J PELE_MPI</span>
<span class="c1">#SBATCH --output=mpi_%j.out</span>
<span class="c1">#SBATCH --error=mpi_%j.err</span>
<span class="c1">#SBATCH --ntasks=48</span>
<span class="c1">#SBATCH --mem-per-cpu=1G</span>


<span class="n">module</span> <span class="n">purge</span>

<span class="n">module</span> <span class="n">load</span> <span class="n">Python</span> <span class="n">PELE</span><span class="o">/</span><span class="mf">1.5</span><span class="o">.</span><span class="mf">0.2524</span>

<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">AdaptivePELE</span><span class="o">.</span><span class="n">adaptiveSampling</span> <span class="n">control_file</span>
</pre></div>
</div>
<p>sbatch slurm.sh</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Simulation</a><ul>
<li><a class="reference internal" href="#input">Input</a><ul>
<li><a class="reference internal" href="#adaptivepele-controlfile">AdaptivePELE controlfile</a></li>
<li><a class="reference internal" href="#pele-controlfile">PELE controlfile</a></li>
</ul>
</li>
<li><a class="reference internal" href="#launch-adaptivepele">Launch AdaptivePELE</a><ul>
<li><a class="reference internal" href="#from-command-line">From command line</a></li>
<li><a class="reference internal" href="#from-queue-system">From queue system</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../Software/Software.html"
                        title="previous chapter">Software</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../GeneralAnalysis/GeneralAnalysis.html"
                        title="next chapter">Basic Analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/intro/AdaptiveMethodology/Simulation/Simulation.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../GeneralAnalysis/GeneralAnalysis.html" title="Basic Analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="../Software/Software.html" title="Software"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">PELE 1.5.${BUILD_TAG} documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../intro.html" >Introduction</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../AdaptiveMethodology.html" >Adaptive Method</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2016 BARCELONA SUPERCOMPUTING CENTER. See the COPYRIGHT file at the top-level directory of this distribution. 
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.
    <a href="../../../index.html#license">License</a>.
    </div>
  </body>
</html>